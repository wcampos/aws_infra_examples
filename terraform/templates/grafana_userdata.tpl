#!/bin/bash

exec 1> user_data.out
2>&1

id

export OPT_MAS_TASK_HANDLER_ETC_AWS_KEY="${OPT_MAS_TASK_HANDLER_ETC_AWS_KEY}"
export OPT_MAS_TASK_HANDLER_ETC_AWS_SECRET="${OPT_MAS_TASK_HANDLER_ETC_AWS_SECRET}"
export OPT_MAS_TASK_HANDLER_ETC_AWS_REGION="${OPT_MAS_TASK_HANDLER_ETC_AWS_REGION}"
export OPT_MAS_TASK_HANDLER_ETC_QUEUE_CONCURRENCY="${OPT_MAS_TASK_HANDLER_ETC_QUEUE_CONCURRENCY}"
export OPT_MAS_TASK_HANDLER_ETC_QUEUE_MESSAGES_TO_PREFETCH="${OPT_MAS_TASK_HANDLER_ETC_QUEUE_MESSAGES_TO_PREFETCH}"
export OPT_MAS_TASK_HANDLER_ETC_QUEUE_PROCESS_EMAIL_BASENAME="${OPT_MAS_TASK_HANDLER_ETC_QUEUE_PROCESS_EMAIL_BASENAME}"
export OPT_MAS_TASK_HANDLER_ETC_ENVIRONMENT_EXTENSION="${OPT_MAS_TASK_HANDLER_ETC_ENVIRONMENT_EXTENSION}"
export endpoint="${endpoint}"



export ETC_MAS_SERVER_SETTINGS_JSON_BUCKET_HOLDING_PDF="${ETC_MAS_SERVER_SETTINGS_JSON_BUCKET_HOLDING_PDF}"
export ETC_MAS_SERVER_SETTINGS_JSON_BUCKET_FOLDER_HOLDING_PDF="${ETC_MAS_SERVER_SETTINGS_JSON_BUCKET_FOLDER_HOLDING_PDF}"
export ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_URL="${ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_URL}"
export ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_API_KEY="${ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_API_KEY}"
export ETC_MAS_SERVER_SETTINGS_JSON_OKTA_AUTH_SERVER_NAME="${ETC_MAS_SERVER_SETTINGS_JSON_OKTA_AUTH_SERVER_NAME}"
export ETC_MAS_SERVER_SETTINGS_JSON_OKTA_AUTH_SERVER_AUDIENCE="${ETC_MAS_SERVER_SETTINGS_JSON_OKTA_AUTH_SERVER_AUDIENCE}"

export ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_URL="${ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_URL}"
export ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_CLIENT_ID="${ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_CLIENT_ID}"
export ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_URL="${ETC_MAS_SERVER_SETTINGS_JSON_OKTA_APP_URL}"

env | sort

ansible-playbook -i "localhost," -c local /etc/ansible_lc/taskhdlr_launch_config.yml